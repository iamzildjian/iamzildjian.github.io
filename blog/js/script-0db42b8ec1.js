"use strict";function getQL(){return{operationName:"getRepoInfo",query:'\n\tquery getRepoInfo($owner: String = "Tomotoes", $weibo: String = "weibo", $gallery: String = "gallery") {\n\t\trepository(owner: $owner, name: $weibo) {\n\t\t\tissues(filterBy: {createdBy: $owner, states: OPEN}) {\n\t\t\t\ttotalCount\n\t\t\t}\n\t\t}\n\t\trepositoryOwner(login: $owner) {\n\t\t\trepository(name: $gallery) {\n\t\t\t\tdescription\n\t\t\t}\n\t\t}\n\t}\n\t'}}function getGithubCount(t,e){$.ajax({url:"https://api.github.com/graphql",type:"post",data:JSON.stringify(getQL()),headers:{Accept:"application/json",Authorization:"bearer ".concat(["9c48ed2297d7d9bf9447","6de723dbf1a6e4adeacd"].join(""))},success:t,error:e})}function initCount(){var e=sessionStorage.getItem("WEIBO-COUNT"),n=sessionStorage.getItem("PHOTO-COUNT");if(!e||!n||"null"===e||"null"===n)return getGithubCount(function(t){n=t.data.repositoryOwner.repository.description.match(/\d+/)[0],e=t.data.repository.issues.totalCount,n&&e&&(document.getElementById("weibo-count").innerText=e,document.getElementById("photo-count").innerText=n,sessionStorage.setItem("WEIBO-COUNT",e),sessionStorage.setItem("PHOTO-COUNT",n))},console.error);document.getElementById("weibo-count").innerText=e,document.getElementById("photo-count").innerText=n}initCount();var header=document.getElementById("header"),headroom=new Headroom(header,{classes:{initial:"headroom",pinned:"headroom--pinned",unpinned:"headroom--unpinned",top:"headroom--top",notTop:"headroom--not-top",bottom:"headroom--bottom",notBottom:"headroom--not-bottom",frozen:"headroom--frozen"}});headroom.init();var _slicedToArray,Strut,reduceMotion,setState,cubeIsHidden,headerIsHidden,template,parent,getParentWidth,parentWidth,directions,palette,setCubeStyles,createCube,sizes,cubes,getDistance,getRotation,getShading,shouldHide,updateSides,tick,parallaxLimit,container,start,maskEl=document.querySelector(".mask"),setNightMode=function(){maskEl.classList.add("night"),sessionStorage.setItem("night","1")},banNightMode=function(){maskEl.classList.remove("night"),sessionStorage.setItem("night","0")};function switchNightMode(){("1"===sessionStorage.getItem("night")?banNightMode:setNightMode)()}"1"===sessionStorage.getItem("night")&&setNightMode(),function(){var r,t=window||this,e=t.BLOG.even,n=t.BLOG.$,o=n("#search"),a=n("#search-wrap"),i=n("#key"),s=n("#back"),c=n("#search-panel"),u=n("#search-result"),d=n("#search-tpl").innerHTML,l="https://tomotoes.com/blog/content.json";var h=n("html"),m={show:function(){t.innerWidth<760&&h.classList.add("lock-size"),c.classList.add("in")},hide:function(){t.innerWidth<760&&h.classList.remove("lock-size"),c.classList.remove("in")}};function p(t){var e="",e=t.length?t.map(function(t){return e=d,n={title:t.title,path:"/blog".concat(t.path),date:new Date(t.date).toLocaleDateString(),tags:t.tags.map(function(t){return"<span>#".concat(t.name,"</span>")}).join("")},e.replace(/\{\w+\}/g,function(t){t=t.replace(/\{|\}/g,"");return n[t]||""});var e,n}).join(""):'<li class="tips"><p>未发现匹配文章</p></li>';u.innerHTML=e}function g(t,e){return e.lastIndex=0,e.test(t)}function f(t){var n,e,o=this.value.trim();o&&(n=new RegExp(o.replace(/[ ]/g,"|"),"gmi"),e=function(t){p(t.filter(function(t){return e=n,g((t=t).title,e)||t.tags.some(function(t){return g(t.name,e)})||g(t.text,e);var e})),m.show()},r?e(r):((o=new XMLHttpRequest).open("GET",l,!0),o.onload=function(){var t;200<=this.status&&this.status<300?(t=JSON.parse(this.response),r=t instanceof Array?t:t.posts,e(r)):console.error(this.statusText)},o.onerror=function(){console.error(this.statusText)},o.send()),t.preventDefault())}o.addEventListener(e,function(){a.classList.toggle("in"),i.value="",a.classList.contains("in")?i.focus():i.blur()}),s.addEventListener(e,function(){a.classList.remove("in"),m.hide()}),document.addEventListener(e,function(t){"key"!==t.target.id&&m.hide()}),i.addEventListener("input",f),i.addEventListener(e,f)}.call(void 0),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",easeOutCubic:function(t,e,n,o,r){return o*((e=e/r-1)*e*e+1)+n},easeOutBounce:function(t,e,n,o,r){return(e/=r)<1/2.75?o*(7.5625*e*e)+n:e<2/2.75?o*(7.5625*(e-=1.5/2.75)*e+.75)+n:e<2.5/2.75?o*(7.5625*(e-=2.25/2.75)*e+.9375)+n:o*(7.5625*(e-=2.625/2.75)*e+.984375)+n}}),function(i){i.fn.bumpyText=function(a){return a=i.extend({bounceHeight:"1.3em",bounceUpDuration:500,bounceDownDuration:700},a),this.each(function(){var t=i(this);if(t.text()===t.html()){for(var e=t.text(),n="",o=0;o<=e.length;o++){var r=e.slice(o,o+1);n+=i.trim(r)?'<span class="bumpy-char">'.concat(r,"</span>"):r}t.html(n),t.find("span.bumpy-char").each(function(){i(this).mouseover(function(){i(this).animate({bottom:a.bounceHeight},{queue:!1,duration:a.bounceUpDuration,easing:"easeOutCubic",complete:function(){i(this).animate({bottom:0},{queue:!1,duration:a.bounceDownDuration,easing:"easeOutBounce"})}})})})}})}}(jQuery),$("#name").bumpyText(),Waves.init(),Waves.attach(".page-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"]),isPhone||(function(){var t=$(".sliding-bar");$(".nav > .items").hover(function(){t.offset($(this).offset())})}(),_slicedToArray=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n,o=[],r=!0,a=!1;try{for(var i,s=t[Symbol.iterator]();!(r=(i=s.next()).done)&&(o.push(i.value),!e||o.length!==e);r=!0);}catch(t){a=!0,n=t}finally{try{!r&&s.return&&s.return()}finally{if(a)throw n}}return o}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Strut={random:function(t,e){return Math.random()*(e-t)+t},arrayRandom:function(t){return t[Math.floor(Math.random()*t.length)]},interpolate:function(t,e,n){return t*(1-n)+e*n},rangePosition:function(t,e,n){return(n-t)/(e-t)},clamp:function(t,e,n){return Math.max(Math.min(t,n),e)},queryArray:function(t,e){return e=e||document.body,Array.prototype.slice.call(e.querySelectorAll(t))},ready:function(t){"complete"==document.readyState?t():document.addEventListener("DOMContentLoaded",t)}},reduceMotion=matchMedia("(prefers-reduced-motion)").matches,setState=function(o,r){return directions.forEach(function(t){var e,n;o[t]+=r[t],Math.abs(o[t])<360||(n=360==(e=Math.max(o[t],360))?Math.abs(o[t]):360,o[t]=e-n)})},headerIsHidden=!(cubeIsHidden=function(t){return parentWidth+30<t}),template=document.getElementById("cube-template"),parent=document.getElementById("header-hero"),parentWidth=(getParentWidth=function(){return parent.getBoundingClientRect().width})(),window.addEventListener("resize",function(){return parentWidth=getParentWidth()}),directions=["x","y"],setCubeStyles=function(t){var e=t.cube,n=t.size,o=t.left,t=t.top;Object.assign(e.style,{width:"".concat(n,"px"),height:"".concat(n,"px"),left:"".concat(o,"px"),top:"".concat(t,"px")}),Object.assign(e.querySelector(".shadow").style,{filter:"blur(".concat(Math.round(.6*n),"px)"),opacity:Math.min(n/120,.4)})},createCube=function(o){var t=document.importNode(template.content,!0),e=t.querySelector(".cube"),n=directions.reduce(function(t,e){var n=o>sizes.m?.3:.6;return t[e]=Strut.random(-n,n),t},{}),r=Strut.queryArray(".sides div",e).reduce(function(t,e){return t[e.className]={side:e,hidden:!1,rotate:{x:0,y:0}},t},{});return r.top.rotate.x=90,r.bottom.rotate.x=-90,r.left.rotate.y=-90,r.right.rotate.y=90,r.back.rotate.y=-180,{fragment:t,cube:e,state:{x:0,y:0},speed:n,sides:Object.values(r)}},(cubes=[{tint:(palette={white:{color:[255,255,255],shading:[160,190,218]},orange:{color:[255,250,230],shading:[255,120,50]},green:{color:[205,255,204],shading:[0,211,136]}}).green,size:(sizes={xs:15,s:25,m:30,l:100,xl:120}).xs,left:25,top:315},{tint:palette.orange,size:sizes.s,left:230,top:535},{tint:palette.white,size:sizes.m,left:1460,top:250}].map(function(t){return Object.assign(createCube(t.size),t)})).forEach(setCubeStyles),getDistance=function(n,o){return directions.reduce(function(t,e){return t[e]=Math.abs(n[e]+o[e]),t},{})},getRotation=function(t,e,n){var o=n.x?"Z":"Y",r=0<n.x?-1:1;return"\n      rotateX(".concat(t.x+n.x,"deg)\n      rotate").concat(o,"(").concat(r*(t.y+n.y),"deg)\n      translateZ(").concat(e/2,"px)\n    ")},getShading=function(n,t,r){var e=directions.reduce(function(t,e){var n=r[e],o=n/180;return t[e]=180<n?Math.abs(2-o):o,t},{});t.x?e.y=0:90<(i=r.x)&&i<270&&directions.forEach(function(t){return e[t]=1-e[t]});var o=(e.x+e.y)/2,a=n.color.map(function(t,e){return Math.round(Strut.interpolate(t,n.shading[e],o))}),t=_slicedToArray(a,3),i=t[0],a=t[1],t=t[2];return"rgb(".concat(i,", ").concat(a,", ").concat(t,")")},shouldHide=function(t,e,n){return t?90<e&&e<270:!(e<90)&&e<270?n<90:90<n&&n<270},updateSides=function(t){var a=t.state,e=t.speed,i=t.size,s=t.tint,n=t.sides,t=t.left;headerIsHidden||cubeIsHidden(t)||(setState(a,e),n.forEach(function(t){var e=t.side,n=t.rotate,o=t.hidden,r=getDistance(a,n);shouldHide(n.x,r.x,r.y)?o||(e.hidden=!0,t.hidden=!0):(o&&(e.hidden=!1,t.hidden=!1),e.style.transform=getRotation(a,i,n),e.style.backgroundColor=getShading(s,n,r))}))},tick=function t(){cubes.forEach(updateSides),reduceMotion||requestAnimationFrame(t)},parallaxLimit=document.querySelector(".bgheader").getBoundingClientRect().height+80,window.addEventListener("scroll",throttle(function(){var n=window.scrollY;if(n<parallaxLimit)return headerIsHidden=!1,void cubes.forEach(function(t){var e=t.cube,t=t.speed;return e.style.transform="translateY(".concat(Math.abs(.5*t.x)*n,"px)")});headerIsHidden=!0},150)),(container=document.createElement("div")).className="cubes",cubes.forEach(function(t){t=t.fragment;return container.appendChild(t)}),start=function(){tick(),parent.appendChild(container)},"requestIdleCallback"in window?requestIdleCallback(start):start());